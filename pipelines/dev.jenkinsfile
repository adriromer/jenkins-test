pipeline {
       agent any
        options {
            skipDefaultCheckout()
            disableConcurrentBuilds()
            timeout(5)
            buildDiscarder(logRotator(numToKeepStr: '5'))
        }
        stages{
                stage ("Load customed libraries"){
                        steps{
                                script{
                                        cleanWs()
                                        library changelog: false, identifier: 'mylibrary@master', retriever: modernSCM([$class: 'GitSCMSource', credentialsId: 'GitHubPusher', remote: 'https://github.com/adriromer/jenkins-test.git', traits: [[$class: 'jenkins.plugins.git.traits.BranchDiscoveryTrait'], [$class: 'CleanAfterCheckoutTrait']]])
                                }
                        }
                }
            }

    stages {
        stage('Git Checkout') {
            steps {
            checkout([$class: 'GitSCM', branches: [[name: '*/master']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: 'GitHubPusher', url: 'https://github.com/adriromer/jenkins-test.git']]])
                   }
        }
    }
}


